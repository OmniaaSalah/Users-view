



<div class="report form-set custom-form">


    <div class="box-shadow bg-white raduis-12 my-3 p-5">
        <h3 class="mb-5 heading heading-secondary fw-bold m-0">{{'dashboard.reports.The columns that you want to add to the table'|translate}}</h3>
    <div class="row custom-form">
        <ng-container *ngFor="let item of tableColumns">
            <div class="col-12 col-md-2 d-flex align-items-center gap-4 mb-5 mx-2">
                <p-checkbox (onChange)="checkValueOfCheckbox($event,item)" [disabled]="item.isDisabled" [(ngModel)]="item.isSelected"
                    [binary]="true"></p-checkbox>

                <label class="label label--sm" for=""> {{item.name}} </label>
            </div>
        </ng-container>
    </div>
    </div>


    <div class="prim-table mt-4" *ngIf="schoolsReport.totalAllData || schoolsReport.loading">
        <p-table #dt [value]="schoolsReport.list" [lazy]="true" (onSort)="onSort($event)" [scrollable]="true">

            <ng-template pTemplate="caption">
                <app-table-caption 
                (onExport)="onExport($event)" 
                (onFilter)="filtration.Page=1;getschoolsReportList()" 
                (onSearch)="filtration.Page=1;filtration.KeyWord = $event; getschoolsReportList()" 
                (onClear)="clearFilter()">
            
                  
                    <div class="row gx-5 form-set">
                        <div class="col-lg-4">
                            <label class="label" for="region">{{'shared.state'|translate }}  </label>
                            <!-- <p-dropdown  [showClear]="true" StopProp [options]="(states$ |async)" [(ngModel)]="filtration.StateId" optionValue="id" optionLabel="{{lang=='ar' ? 'name.ar': 'name.en'}}" placeholder="{{'shared.chooseState'|translate }}"></p-dropdown> -->
                            <p-multiSelect [options]="(states$ |async)" display="chip" [(ngModel)]="filtration.StateId" optionValue="id" optionLabel="{{lang=='ar' ? 'name.ar': 'name.en'}}" placeholder="{{'shared.chooseState'|translate }}"></p-multiSelect>
                        </div>
                        <div class="col-lg-4">
                            <label class="label" for="curriculum">{{'shared.curriculum'|translate }}  </label>
            
                            <!-- <p-dropdown  [showClear]="true" StopProp [options]="(curriculums$ | async)" [(ngModel)]="filtration.CurriculumId" optionValue="id" inputId="curriculum" optionLabel="name.ar" placeholder="{{'shared.chooseCurriculum'|translate }}"></p-dropdown> -->
                            <p-multiSelect  [options]="(curriculums$ | async)" display="chip" [(ngModel)]="filtration.CurriculumId" optionValue="id"  optionLabel="name.ar" placeholder="{{'shared.chooseCurriculum'|translate }}"></p-multiSelect>
            
                        </div>
            
                        <div class="col-lg-4">
                            <label class="label" for="curriculum">{{'dashboard.schools.hasSpecialClasses'|translate }}  </label>
            
                            <p-dropdown  [showClear]="true" StopProp [options]="booleanOptions" [(ngModel)]="filtration.HasSpecialEducationClasses" optionValue="value" inputId="curriculum" optionLabel="name" placeholder="{{'shared.yesOrNo'|translate }}"></p-dropdown>
            
                        </div>
                    </div>
                </app-table-caption>
            
            </ng-template>


            <ng-template pTemplate="header" let-columns="columns">
                <tr>
                    <ng-container *ngFor="let column of tableColumns" >
                        <th [pSortableColumn]="column.name.ar" *ngIf="column.isSelected == true"> 
                            <!-- studentsReportsArray -->
                            <p-sortIcon field="{{column.name }}"></p-sortIcon>{{column.name }}
                        </th>
                    </ng-container>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-school>
                <tr>
                    <ng-container>
                        <td>
                            {{school.schoolName | currentLang}} 
                        </td>
                       
                        <td>
                            {{school.state | currentLang}}
                        </td>
                        <td>
                            {{school.teachersNumbers }}
                        </td>
                        <td>
                            {{school.studentsNumber }}
                        </td>
                        <td>
                            {{school.studentsPercentageInSchool }} %
                        </td>
                        <td>
                            {{school.curriculumName | currentLang}}
                          
                        </td>

                        <td *ngIf="tableColumns[6].isSelected == true">
                            {{school.gradeName | currentLang}}
                        </td>
                        <td *ngIf="tableColumns[7].isSelected == true">
                            {{school.divisionName | currentLang}}
                        </td>
                        <td *ngIf="tableColumns[8].isSelected == true">
                            {{school.studentsPercentageInDivision}} %
                        </td>
                       
                    </ng-container>
                    
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td [attr.colspan]="20" class="search">
                        <ng-container *ngIf="schoolsReport.totalAllData && schoolsReport.list.length == 0 &&  !schoolsReport.loading">
                            <app-informative-block subTitle="{{'emptyList.noDataMatch' |translate}}"
                                src="assets/images/empty-list/empty-list.svg"></app-informative-block>
                        </ng-container>

                        <app-loader></app-loader>
                    </td>
                </tr>
            </ng-template>
        </p-table>

        <div class="" *ngIf="schoolsReport.total  > paginationState.rows">
            <app-pagination [totalItems]="schoolsReport.total"
                (paginationChanged)="paginationChanged($event)"></app-pagination>
        </div>
    </div>

    <ng-container *ngIf="!schoolsReport.totalAllData && !schoolsReport.loading">
        <app-informative-block title="{{'emptyList.schools' |translate}}"
            src="assets/images/empty-list/empty-list.svg"></app-informative-block>
    </ng-container>
</div>

