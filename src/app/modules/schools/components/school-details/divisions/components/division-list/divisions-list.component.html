
<div class="prim-table mt-4" *ngIf="divisions.totalAllData || divisions.loading">
    <p-table #dt [value]="divisions.list" [scrollable]="true">
        <ng-template pTemplate="caption">
            <app-table-caption [seachKeyword]="filtration.KeyWord" (onExport)="onExport($event)" (onFilter)="this.filtration.Page=1;getSchoolDivisions()" (onSearch)="this.filtration.Page=1;filtration.KeyWord = $event; getSchoolDivisions()" (onClear)="clearFilter()">

                <div class="row gx-5 form-set">
                    <div class="col-md-4" *ngIf="schoolGrades$ |async as schoolGrades">
                        <label class="label" for="status">{{'shared.grade'|translate }} </label>
                        <p-multiSelect [lazy]="true" [options]="schoolGrades" display="chip"  [(ngModel)]="filtration.gradeid" optionValue="id" optionLabel="{{lang=='ar'? 'name.ar' : 'name.en'}}" placeholder="{{'shared.grade'|translate }}"></p-multiSelect>
                    </div>
                    <div class="col d-flex gap-5 justify-content-end align-items-center align-self-end" >
                            <button  class="btn btn-primary btn--sm px-5" *permit="claimsEnum.SE_A_Division" (click)="addNewDivision()">
                                <span>{{'schools.addDivisionToschool'| translate}}</span>
                            </button>
                    </div>
                </div>
            </app-table-caption>

        </ng-template>

        <ng-template pTemplate="header">
            <tr>
                <th style="min-width: 15rem;" pSortableColumn="code">{{'shared.division' |translate}}
                    <p-sortIcon field="code"></p-sortIcon>
                </th>
                <th pSortableColumn="name">{{'shared.grade' |translate}}
                    <p-sortIcon field="name"></p-sortIcon>
                </th>
                <th style="min-width: 15rem;" pSortableColumn="category">{{'schools.roomNumber' |translate}}
                    <p-sortIcon field="category"></p-sortIcon>
                </th>
                <th style="min-width: 15rem;" pSortableColumn="quantity">{{'schools.StudentDensity' |translate}}
                    <p-sortIcon field="quantity"></p-sortIcon>
                </th>
                <th style="min-width: 18rem;" pSortableColumn="quantity">{{'schools.maxStudentsNumber' |translate}}
                  <p-sortIcon field="quantity"></p-sortIcon>
                </th>
                <th style="min-width: 20rem;" pSortableColumn="quantity">{{'schools.exceptionStudentNumber' |translate}}
                  <p-sortIcon field="quantity"></p-sortIcon>
                </th>
                <th style="min-width: 15rem;" pSortableColumn="price">{{'students.withDisabilities' |translate}}
                    <p-sortIcon field="price"></p-sortIcon>
                </th>
                <th style="min-width: 15rem;" pSortableColumn="quantity">{{'schools.sectionManager' |translate}}
                    <p-sortIcon field="quantity"></p-sortIcon>
                </th>
                <th alignFrozen="left" pFrozenColumn [frozen]="true" class="actions" pSortableColumn="actions"></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-division>
            <tr [routerLink]="['division/',division.id]">
                <td style="min-width: 15rem;">{{division?.name |currentLang}}</td>
                <td>{{division?.gradeName |currentLang}}</td>
                <td style="min-width: 15rem;">{{division?.classRoomNumber}}</td>
                <td style="min-width: 15rem;">{{division?.studentCount ? division?.studentCount : 0}}</td>
                <td style="min-width: 18rem;">{{division?.maxStudentCount ? division?.maxStudentCount : 0}}</td>
                <td style="min-width: 20rem;"> {{division?.studentToleranceCount ? division?.studentToleranceCount :0}}</td>
                <td style="min-width: 15rem;"><span *ngIf="division?.isSpecialAbilities">{{'true'|translate}}</span><span *ngIf="!division.isSpecialAbilities">{{'false'|translate}}</span></td>
                <td style="min-width: 15rem;">{{division?.teacherName |currentLang}}</td>
                <td class="actions edit"  pFrozenColumn [frozen]="true">
                   <!-- <button class="btn btn--sm btn-outline-none" routerLink="/grades-and-divisions/school/{{schoolId}}/divisions/division/{{division.id}}" >
                        <span>{{'shared.edit' |translate}}</span>
                        <img  src="assets/images/shared/arrow.svg" alt="">
                    </button> -->

                    <ng-container *ngIf="currentUserScope==userScope.Employee">
                        <div class="d-flex justify-content-center">
                            <div role="button" class=" d-flex gap-3 justify-content-end align-items-center mx-4" routerLink="/grades-and-divisions/school/{{schoolId}}/divisions/division/{{division.id}}" >
                                <span class="color-skyBlue-400">{{'shared.edit'|translate}}</span>
                                <img  [class.rotate180]="lang=='en'" src="assets/images/shared/left-arrow.svg" alt="">
                            </div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="currentUserScope==userScope.SPEA">
                        <div role="button" class=" d-flex gap-3 justify-content-end align-items-center mx-4" [routerLink]="['division',division.id]">
                            <span class="color-skyBlue-400">{{'shared.edit'|translate}}</span>
                            <img  [class.rotate180]="lang=='en'" src="assets/images/shared/left-arrow.svg" alt="">
                        </div>
                    </ng-container>
                </td>
                <!-- <td ><app-dropdown [items]="menuItems"></app-dropdown></td> -->
            </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td [attr.colspan]="20">
                    <ng-container *ngIf="divisions.totalAllData && divisions.list.length == 0 &&  !divisions.loading">
                        <app-informative-block subTitle="{{'emptyList.noDataMatch' |translate}}" src="assets/images/empty-list/empty-list.svg"></app-informative-block>
                    </ng-container>

                    <app-loader></app-loader>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div class="" *ngIf="divisions.total > paginationState.rows">
        <app-pagination [currentPage]="filtration.Page" [totalItems]="divisions.total" (paginationChanged)="paginationChanged($event)"></app-pagination>
    </div>
</div>
<ng-container *ngIf="!divisions.totalAllData && !divisions.loading">
    <app-informative-block subTitle="{{'emptyList.divisions' |translate}}" src="assets/images/empty-list/empty-list.svg"></app-informative-block>
</ng-container>


<app-division-modal [schoolId]="schoolId" [classId]="gardeId" (onDivisionModelClosed)="getSchoolDivisions()"></app-division-modal>
