<div  style="overflow-x: hidden;">

  <div class="d-flex ">
 
    <div id="content" >
   

    
        <div class="container mt-5 custom-form custom-validation-form border" style="padding-bottom: 21rem;">
          <ng-container *ngIf="!jobRole&&urlParameter">
            <div class="row g-5">
               
                    <app-skeleton count="6"  [style]="{'margin-bottom': '3rem'}"></app-skeleton>
            
            </div>
        
         </ng-container>
            <form [formGroup]="roleFormGrp" class="container-fluid  " (ngSubmit)="succeeded()" *ngIf="jobRole||!urlParameter">
                <div class=" row gx-5 form-set ">
                    <div class="col-xs-2 col-lg-4">
                        <label for="PID" class="label">{{'dashboard.UserRole.JobRole Name In Arabic'|translate}} <span class="star">*</span></label>
                        <input type="text" pInputText formControlName="jobRoleNameInArabic" [LangRestrict]="'ar'"  class="form-control"   name="PID" id="PID" placeholder="{{'dashboard.UserRole.Write Job Role Name'|translate}}">
                        <div>
                          <div [hidden]="jobRoleNameInArabic.valid || jobRoleNameInArabic.untouched">
                              <small *ngIf="jobRoleNameInArabic.errors?.['required']"  id="helpId" class="form-text text-muted d-block  " class="alert-danger">
                                {{'shared.This Field is Required'|translate}}
                                 <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                              </small>
                             
                              <small *ngIf="jobRoleNameInArabic.errors?.['maxlength']" id="helpId2" class="form-text text-muted d-block " class="alert-danger" >
                                  {{'shared.Numbres Of Characters must not more than 65 character'|translate}}
                                  <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                              </small>

                            
                           </div>
                         
                              
                          </div>
                    </div>
                    <div class="col-xs-2 col-lg-4">
                      <label for="PID" class="label">{{'dashboard.UserRole.JobRole Name In English'|translate}} <span class="star">*</span></label>
                      <input type="text" pInputText formControlName="jobRoleNameInEnglish"  class="form-control leftaction" [LangRestrict]="'en'" name="PID" id="PID" placeholder="{{'dashboard.UserRole.Write Job Role Name'|translate}}">
                      <div>
                        <div [hidden]="jobRoleNameInEnglish.valid || jobRoleNameInEnglish.untouched">
                            <small *ngIf="jobRoleNameInEnglish.errors?.['required']"  id="helpId" class="form-text text-muted d-block  " class="alert-danger">
                              {{'shared.This Field is Required'|translate}}
                               <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                            </small>
                           
                            <small *ngIf="jobRoleNameInEnglish.errors?.['maxlength']" id="helpId2" class="form-text text-muted d-block " class="alert-danger" >
                                {{'shared.Numbres Of Characters must not more than 65 character'|translate}}
                                <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                            </small>

                          
                         </div>
                       
                            
                        </div>
                  </div>
                  <div class="col-xs-2 col-lg-2  switch">

                    <label for="PID2" class="label">{{'dashboard.UserRole.JobRole Status'|translate}} <span class="star">*</span></label>
                    <div class="d-flex gap-3 status">

                        <span class="text">{{'shared.activated'|translate}}</span>
                        <p-inputSwitch  (onChange)="isToggleLabel($event)" formControlName="status"  ></p-inputSwitch>
                        <span class="Label" *ngIf="!isShown && !urlParameter">{{'shared.no'|translate}}</span>
                        <span class="Label" *ngIf="isShown && !urlParameter">{{'shared.yes'|translate}}</span>
                        <span class="Label" *ngIf=" urlParameter&&!jobRole.status ">{{'shared.no'|translate}}</span>
                        <span class="Label" *ngIf="urlParameter&&jobRole.status">{{'shared.yes'|translate}}</span>
                    </div>
                   
                </div>
               

                 
                </div>
                <div class=" row gx-5 form-set ">

               <div class="col-xs-2 col-lg-4" >
                     
                <label for="PID5" class="label">{{'dashboard.UserRole.Description In Arabic'|translate}}</label>
         
                <input type="text" pInputText formControlName="descriptionInArabic" class="form-control "  [LangRestrict]="'ar'"  name="PID5" id="PID5" placeholder="{{'dashboard.UserRole.Write Description'|translate}}">
                <div>
                    <div [hidden]="descriptionInArabic.valid || descriptionInArabic.untouched">
                       
                       
                        <small *ngIf="descriptionInArabic.errors?.['maxlength']" id="helpId2" class="form-text text-muted d-block " class="alert-danger" >
                          {{'shared.Numbres Of Characters Must not More than 256 character'|translate}}
                          <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                      </small>
                     </div>
                        
                </div>
                
            </div>
            <div class="col-xs-2 col-lg-4">
                 
              <label for="PID5" class="label">{{'dashboard.UserRole.Description In English'|translate}}</label>
       
              <input type="text" pInputText formControlName="descriptionInEnglish" class="form-control  leftaction"  [LangRestrict]="'en'" name="PID5" id="PID5" placeholder="{{'dashboard.UserRole.Write Description'|translate}}">
              <div>
                  <div [hidden]="descriptionInEnglish.valid || descriptionInEnglish.untouched">
                     
                     
                      <small *ngIf="descriptionInEnglish.errors?.['maxlength']" id="helpId2" class="form-text text-muted d-block " class="alert-danger" >
                        {{'shared.Numbres Of Characters Must not More than 256 character'|translate}}
                        <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                    </small>
                   </div>
                      
              </div>
              
             </div>
                <!-- <div class="col-xs-2 col-lg-4">
                   

                     

                    <label for="rolePowers" class="label">{{'dashboard.UserRole.RolePowers'|translate}} <span class="star">*</span></label>
                    <p-multiSelect 
                    [options]="rolePowersList" selectedItemsLabel="ellipsis"
                    display="chip" 
                    optionLabel="name.ar" 
                    optionValue="id" 
                    formControlName="rolePowers" 
                    [ngClass]="{'ng-invalid ng-dirty':rolePowers.errors?.required && rolePowers.touched}" name="PID4" id="PID4" styleClass="p-multiselect" 
                    defaultLabel="{{'dashboard.UserRole.Select Role Powers'|translate}}">
                    </p-multiSelect>
                  
             
                    <div>
                        <div [hidden]="rolePowers.valid || rolePowers.untouched">
                            <small *ngIf="rolePowers.errors?.['required']"  id="helpId" class="form-text text-muted d-block  " class="alert-danger">
                              {{'shared.This Field is Required'|translate}}
                               <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                            </small>
                           
                            
                         </div>
                         
                            
                    </div>
                   
                </div> -->

                 
             </div>
             <div class=" row gx-4 form-set ">
              <div class="col-xs-2 col-lg-8">

                <label for="rolePowers" class="label">{{'dashboard.UserRole.RolePowers'|translate}} <span class="star">*</span></label>
               
                <div class="myInput myInput--full myInput--search p-input-icon-right ms-auto">
                  <i class="pi pi-search fs-3 "></i>
                  <input class="input" type="text"  [formControl]="searchText"  pInputText placeholder="{{'shared.Search...'|translate}}" />
               </div>
                <div class="row gx-5 gy-4 form-set mt-5 contain"[ngClass]="rolePowersList?.length>5?'scroll':''">
                  <ng-container *ngFor="let item of rolePowersList | localizeSearch :searchText.value; let i = index">
                      <div class="col-md-4 d-flex gap-4 align-items-center mb-3">
               
                          <p-checkbox  [value]="item.id"  name="parents" [ngModelOptions]="{standalone: true}"  [(ngModel)]="rolePowersIdList"></p-checkbox>
                          <label class="label label--sm" for=""> {{item.name|currentLang}} </label>
                      </div>
                  </ng-container>

                </div>

              </div>
             </div>
             <div class=" row gx-4 form-set ">

              <div class="col-xs-2 col-lg-8">
                          
                <label for="PID3" class="label">{{'dashboard.UserRole.DataRestrictionLevel'|translate}} <span class="star">*</span></label>

                  <p-dropdown [options]="dataRestrictionLevelList" (onChange)="changedRestriction($event.value)" optionLabel="name.ar" optionValue="name.en" formControlName="datarestrictionLevel"   placeholder="{{'dashboard.UserRole.Select Data Restriction Level'|translate}}"      [ngClass]="{'ng-invalid ng-dirty':datarestrictionLevel.errors?.required && datarestrictionLevel.touched}" name="PID3" id="PID3"  ></p-dropdown>
                  <div>
                    <div [hidden]="datarestrictionLevel.valid || datarestrictionLevel.untouched">
                        <small *ngIf="datarestrictionLevel.errors?.['required']"  id="helpId" class="form-text text-muted d-block  " class="alert-danger">
                          {{'shared.This Field is Required'|translate}}
                           <fa-icon  [icon]="exclamationIcon"  class="dangericon ms-1 "></fa-icon>
                        </small>
                    </div>
                  </div>
        
            </div>
             
          </div>
             <div class="row gx-4 gy-5 form-set "  *ngIf="showCurriculamList">
             
                    <p class="heading heading--tertiary mb-3 mt-5">{{'dashboard.UserRole.Select curriculums' | translate}}</p>
                    <div  formArrayName="curriculumSelected" class="d-flex curriclums" >
                    <ng-container  *ngFor="let cu of curriculumSelectedArr.controls let i=index">
                  
                      
                        <div class=" d-flex gap-2 align-items-center col-lg-3"  >
                        
                            <p-checkbox *ngIf="curriculamList[i]?.name.ar" class="col-lg-1" [formControlName]="i" binary="true" (onChange)="getCurriculumsAdded($event,curriculamList[i].id)"  [inputId]="i" ></p-checkbox>
                            <label class="label label--sm  col-lg-7" > {{curriculamList[i]?.name.ar}}</label>
                        </div>
                     
                    </ng-container>
                    </div>
            </div>

            <div class="row gx-4 gy-5 form-set " *ngIf="showSchoolList">
             
              <div class="d-flex align-items-center   ">
                <div class="btn btn-outline-skyBlue " role="button" (click)="openSelectSchoolsModel()">
                    {{'dashboard.UserRole.Select School'|translate}}
                </div>
                </div>

                <div class="prim-table mt-4 col-lg-8" *ngIf="MarkedListLength&&!selectSchoolModelOpened">
                  <p-table #dt  [value]="schoolIsSelectedList" sortMode="single"  [scrollable]="true" scrollHeight="350px" [virtualScroll]="true" [virtualRowHeight]="30" >

                      <ng-template pTemplate="header" >
                          <tr>
                             
                              <th pSortableColumn="name.ar" style="min-width:27rem">
                                <p-sortIcon field="name"></p-sortIcon>
                                {{'dashboard.schools.schoolName'|translate}}
            
                              </th>
                              <th pSortableColumn="state.ar">
                                <p-sortIcon field="state"></p-sortIcon>
                                {{'shared.state'|translate}}
                              </th>
                              <th pSortableColumn="curriculum.ar">
                                <p-sortIcon field="curriculum"></p-sortIcon>
                                {{'shared.curriculum'|translate}}
                                 
                              </th>
                              <th  class="actions" ></th>
                          </tr>
                      </ng-template>
            
                      <ng-template pTemplate="body" let-school>
            
                          
                              <tr *ngIf="school.isSelected">
                               
                                  <td style="min-width:27rem">{{school.name.ar}}</td>
                                  <td>{{school.state.ar}}</td>
                                  <td>{{school.curriculum.ar}}</td>
                                  <td class="actions">
                                    <button   (click)="unSelectMe(school.id)">
                                      <img  src="assets/images/shared/cancel.svg" alt="">
                                   </button>
                                  </td>
                              </tr>
                      </ng-template>
            
                   
                    
            
                  </p-table>
                 
            
              </div>
            
              <ng-container *ngIf="!MarkedListLength&&!selectSchoolModelOpened">
                  <app-informative-block title="{{'emptyList.Schools not selected yet' |translate}}" subTitle="{{'emptyList.Pleaze, Select School' |translate}}" src="assets/images/empty-list/empty-list.svg"></app-informative-block>
              </ng-container>
              <div class="alert col-lg-8" *ngIf="MarkedListLength&&!selectSchoolModelOpened">
                <p>{{'dashboard.UserRole.exist'|translate}} {{MarkedListLength}} {{'dashboard.UserRole.school selected for this role'|translate}}</p>
             </div>
    
           </div>


              <div class=" d-flex align-items-center justify-content-end ">
                    <div class="Btn-group d-flex gap-3">
                      <button class="btn  btn-primary addBtn" [disabled]="roleFormGrp.invalid||isBtnLoading||!rolePowersIdList.length">
                        {{'shared.save'|translate}}
                        <div class="spinner-border text-light" role="status" *ngIf="isBtnLoading"></div>
                      </button>
                      <button *ngIf="urlParameter" ><a routerLink="/dashboard/manager-tools/user-roles/role-details/{{this.urlParameter}}" class="cancelbtn">{{'shared.cancel'|translate}}</a></button>
                      <button *ngIf="!urlParameter" ><a routerLink="/dashboard/manager-tools/user-roles/user-roles-list" class="cancelbtn">{{'shared.cancel'|translate}}</a></button>
                    </div>
              </div>
               
            </form>
          </div>                   
   
      
     
 
  </div>
</div>

</div>

<!-- SelectSchools -->
<div *ngIf="selectSchoolModelOpened">
<app-select-schools selectSchoolModelOpened="selectSchoolModelOpened"></app-select-schools>
</div>