<div class="report form-set custom-form">

    <div class="prim-table mt-4" *ngIf="studentsReport.totalAllData || studentsReport.loading">
        <p-table #dt [value]="studentsReport.list" [lazy]="true" (onSort)="onSort($event)">

            <ng-template pTemplate="caption">
                <app-table-caption (onExport)="onExport($event)" (onFilter)="getStudents()" 
                (onSearch)="filtration.KeyWord = $event; getStudents()" (onClear)="clearFilter()">

                <div class="col-md-12" >
                    <label class="label">{{'dashboard.students.schoolName'| translate}}</label>
                    <p-multiSelect 
                    [options]="(schools$| async)?.data"  
                    display="chip"
                    [(ngModel)]="filtration.SchoolsId" 
                    (onClear)="isSchoolSelected=false;clearFilter()"
                    (onChange)="checkVlaueOfSelect($event)"
                    optionValue="id"
                    [showClear]="true" 
                    placeholder="{{'shared.chooseSchool'|translate }}" 
                    optionLabel="name.ar"></p-multiSelect>
                </div>



                </app-table-caption>
    
            </ng-template>


            <ng-template pTemplate="header" let-columns="columns">
                <tr>
                    <ng-container *ngFor="let column of tableColumns" >
                        <th [pSortableColumn]="column.name.ar" *ngIf="column.isSelected == true"> 
                            <!-- studentsReportsArray -->
                       <ng-container >{{column.name | currentLang}}</ng-container> 
                       <p-sortIcon field="{{column.name | currentLang}}"></p-sortIcon>
                    </th>
                    </ng-container>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-student>
                <tr>
                    <ng-container>
                        <td>
                            {{student.studentDaleelNumber}}
                        </td>
                        <td>
                            {{student.name | currentLang}} - {{student.surName | currentLang}}
                        </td>
                        <td>
                            {{student.studentNumber}}
                        </td>
                        <td>
                            {{student.currentSchoolName | currentLang}}
                        </td>
                    </ng-container>
                    
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td [attr.colspan]="20">
                        <ng-container *ngIf="!students.total &&  !students.loading">
                            <app-informative-block subTitle="{{'emptyList.noDataMatch' |translate}}"
                                src="assets/images/empty-list/empty-list.svg"></app-informative-block>
                        </ng-container>

                        <app-loader></app-loader>
                    </td>
                </tr>
            </ng-template>
        </p-table>

        <div class="" *ngIf="studentsReport.total  > paginationState.rows">
            <app-pagination [totalItems]="studentReport.total"
                (paginationChanged)="paginationChanged($event)"></app-pagination>
        </div>
    </div>

    <ng-container *ngIf="!studentsReport.totalAllData && !studentsReport.loading">
        <app-informative-block title="{{'emptyList.students' |translate}}"
            src="assets/images/empty-list/empty-list.svg"></app-informative-block>
    </ng-container>
</div>