
<router-outlet></router-outlet>


<ng-container *ngIf="currentUserScope==userScope.SPEA">
    
    <div class="school position-relative">
        <div class="actions-btn d-flex justify-content-end position-absolute bottom-100 gap-3">
            <!-- <button *ngIf="isSchoolAllowToTransferGroup$|async" class="btn  btn-primary btn--md" routerLink="/dashboard/school-management/school/{{schoolId}}/transfer-students">
                <span>{{'dashboard.students.TransferStudentGroup'| translate}}</span>
            </button> -->
            <button class="btn btn-primary btn--md" (click)="showDialog()">
                <span>{{'dashboard.schools.contactWithShoolManagement'| translate}}</span>
            </button>
        </div>
    
        <div class="tabView" [class.show-controls]="navListLength > 7">
    
            <!-- nav Controls -->
            <div class="arrow-left" (click)="scrollLeft(nav)">
                <img src="assets/images/shared/chevron-left.svg" alt="">
            </div>
            <div class="arrow-right" (click)="scrollRight(nav)" [class.d-none]="hideNavControl">
                <img src="assets/images/shared/chevron-right.svg" alt="">
            </div>
            <!-- Navigations Options -->
            <ul class="tabView__nav" [class.pe-0]="hideNavControl" #nav>
                <ng-container *ngFor="let step of steps; let first=first">
                    <li class="tabView__nav__link" *permit="step.claims" [class.active]="step.isActive" (click)="setActiveTab(step.index)"><span>{{step.title}}</span> </li>
                </ng-container>
                

                <!-- <li class="tabView__nav__link" data-step="0" *permit="claimsEnum.E_MenuItem_EditList" [class.active]="step==0" (click)="setActiveTab(0)"><span>{{ 'dashboard.schools.generalInfo'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="1" [class.active]="step==1" (click)="setActiveTab(1);loadMap()"><span>{{ 'dashboard.schools.schoolAddress'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="2" *permit="claimsEnum.E_MenuItem_SchoolEmployee" [class.active]="step==2" (click)="setActiveTab(2)"><span> {{ 'dashboard.schools.schoolEmployee'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="3" *permit="claimsEnum.E_MenuItem_SchoolDivisions" [class.active]="step==3" (click)="setActiveTab(3)"><span>{{ 'dashboard.schools.schoolClasses'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="4" *permit="claimsEnum.E_MenuItem_SchoolGrades" [class.active]="step==4" (click)="setActiveTab(4)"><span>{{ 'dashboard.schools.schoolTracks'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="5"  *permit="claimsEnum.E_MenuItem_EditList"  [class.active]="step==5" (click)="setActiveTab(5)"><span>{{ 'dashboard.schools.editableList'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="6" *permit="claimsEnum.E_MenuItem_Subjects" [class.active]="step==6" (click)="setActiveTab(6)"><span>{{ 'dashboard.schools.schoolSubjects'|translate }}</span></li>
                <li class="tabView__nav__link" data-step="7" *permit="claimsEnum.E_MenuItem_AnnualHolidays" [class.active]="step==7" (click)="setActiveTab(7)"><span>{{ 'dashboard.schools.annualHolidays'|translate }}</span></li> -->
            </ul>
            <!-- Navigations Options -->
    
            <div class="tabView__content">
    
                <div class=" ">
                    <!-- general Info -->
    
                    <ng-container *ngIf="step==0">
                        <app-school-info ></app-school-info>
           
                    </ng-container>
                    <!-- general Info -->
    
    
    
                    <!-- school Location -->
                    <div class="row gx-5 ">
                        <h4 class="heading heading--tertiary mb-5" [class.d-none]="step!=1">{{'dashboard.schools.schoolLocation'|translate }}</h4>
                        <div class="col-md-6 px-5">
                            <div class="map-container" [class.hide]="step!=1">
    
                                <div class="row map-container mb-2">
                                    <!-- Google Map -->
                                    <div #map id="map" class="map"></div>
                                </div>
                            </div>
                        </div>
    
                        <ng-container *ngIf="step==1">
                            <div class="col-md-3 align-self-center grid-container">
                                <span class="paragraph paragraph--sm color-gray-200">{{'shared.city'|translate }}</span>
                                <p class="color-primary"> {{school?.address?.city |currentLang}}</p>
    
                                <span class="paragraph paragraph--sm color-gray-200">{{'shared.state'|translate }}</span>
                                <p class="color-primary">{{school?.address?.state.name?.ar}}</p>
    
                                <span class="paragraph paragraph--sm color-gray-200">{{'shared.street'|translate }}</span>
                                <p class="color-primary">{{school?.address?.street.name |currentLang}}</p>
                            </div>
    
                            <div class="col-md-3 align-self-center">
                                <div class="mb-5 pe-4">
                                    <!-- <img src="assets/images/shared/qrc.svg" alt=""> -->
                                    <!-- https://www.google.com/maps/place/25%C2%B004'53.8%22N+55%C2%B012'59.2%22E/@25.0816221,55.216448,17z/data=!4m4!3m3!8m2!3d25.0816221!4d55.216448 -->
                                    <qr-code [value]="school?.address?.locationURL" size="160"  errorCorrectionLevel="L"></qr-code>
                                    <!-- <span></span> -->
    
                                </div>
                                <p class="paragraph paragraph--sm color-gray-800">{{'You should Read Code from Mobile to get Location in Google Map'|translate}}</p>
                              
    
                            </div>
    
                        </ng-container>
                    </div>
                    <!-- school Location -->
    
    
                    <!-- school manager -->
                    <ng-container *ngIf="step==2">
                        <app-school-employees></app-school-employees>
                    </ng-container>
                    <!-- school managar -->
    
    
                    <!-- school Classes -->
                    <ng-container *ngIf="step==3">
                        <app-school-grades (setActiveTab)="step=$event" (selectedGradeId)="selectedGradeId =$event"></app-school-grades>
                    </ng-container>
                    <!-- school Classes -->
    
    
                    <!-- school Divitions -->
                    <ng-container *ngIf="step==4">
                        <app-school-divisions [selectedGradeId]="selectedGradeId"></app-school-divisions>
                    </ng-container>
                    <!-- School Section -->
    
    
                    <!-- Edit list -->
                    <ng-container *ngIf="step==5">
                        <app-edit-list [editList]="schoolClasses"></app-edit-list>
                    </ng-container>
                    <!-- Edit list -->
    
    
    
                    <!-- School Subjects -->
                    <ng-container *ngIf="step==6">
                        <app-school-subjects [subjects]="schoolClasses"></app-school-subjects>
                    </ng-container>
                    <!-- School Subjects -->
    
    
                    <ng-container *ngIf="step==7">
                        <app-annul-holiday-list [holidays]="schoolClasses"></app-annul-holiday-list>
                    </ng-container>
    
    
                </div>
            </div>
        </div>
    
    </div>
</ng-container>

<p-dialog header="{{'dashboard.Messages.Send a new message' | translate}}" [draggable]="false" [resizable]="false" [modal]="true"
[(visible)]="display" [style]="{'width': '50vw'}" class="dialog-header" [baseZIndex]="10000">
<form [formGroup]="speaEmpForm">
    <div class="custom-form">
<div class="form-group">
    <label for="">{{'dashboard.Messages.Enter the message title' | translate}} <span class="star">*</span></label>
    <input maxlength="32" class="form-control py-3 my-3" type="text" formControlName="title" placeholder="{{'dashboard.Messages.Enter the message title' | translate}}">
    <div class="text-danger"
    *ngIf="this.speaEmpForm.get('title')?.touched && this.speaEmpForm.get('title')?.invalid && this.speaEmpForm.get('title')?.errors">
    <small *ngIf="this.speaEmpForm.get('title')?.errors?.['required']">{{'dashboard.Messages.descriptionMessage' | translate}}</small>
    <small *ngIf="this.speaEmpForm.get('title')?.errors?.['maxlength']">{{'dashboard.Messages.maxLengtho' | translate}}</small>
</div>
</div>

<div class="form-group">
    <label for="">{{'dashboard.Messages.MessageType' | translate}} <span class="star">*</span></label>
    <p-dropdown  [options]="messagesTypes" optionLabel="name.ar" optionValue="id" formControlName="messageType" placeholder="{{'dashboard.Messages.MessageType' | translate}}" appValidation  ></p-dropdown>
    <div class="text-danger"
    *ngIf="this.speaEmpForm.get('messageType')?.touched && this.speaEmpForm.get('messageType')?.invalid && this.speaEmpForm.get('messageType')?.errors">
    <small *ngIf="this.speaEmpForm.get('messageType')?.errors?.['required']">{{'dashboard.Messages.descriptionMessage' | translate}}</small>
</div>
</div>

<div class="d-flex El-form my-4">
    <div class="form-group d-flex field1">
        <label  class="px-3" for="">{{'dashboard.Messages.Require confirmation of receipt' | translate}}</label>
        <p-inputSwitch  (onChange)="isToggleLabel($event)"  class="px-3" formControlName="switch1"></p-inputSwitch>

        <!-- <span class="Label" *ngIf="!isShown">{{'shared.no'|translate}}</span>
        <span class="Label" *ngIf="isShown">{{'shared.yes'|translate}}</span> -->

    </div>
    <div class="form-group d-flex">
        <label    class="px-3" for="">  {{'dashboard.Messages.Possibility to reply' | translate}} <span class="star">*</span></label>
        <p-inputSwitch  (onChange)="isToggleLabel1($event)"  class="px-3" formControlName="switch2"></p-inputSwitch>  
        <!-- <span class="Label" *ngIf="!isShown1">{{'shared.no'|translate}}</span>
        <span class="Label" *ngIf="isShown1">{{'shared.yes'|translate}}</span> -->
    </div>
</div>

<div class="form-group d-flex mb-3 mx-3">
    <label for="">{{'dashboard.Messages.senderName' | translate}}</label>
    <p-inputSwitch  (onChange)="isToggleLabel2($event)" class="px-5"  formControlName="switch3"></p-inputSwitch>
    <!-- <span class="Label" *ngIf="!isShown2">{{'shared.no'|translate}}</span>
    <span class="Label" *ngIf="isShown2">{{'shared.yes'|translate}}</span> -->
</div>

<div class="form-group">
    <label for="">{{'dashboard.Messages.Enter the text of the message' | translate}} <span class="star">*</span></label>
    <textarea maxlength="512" class="form-control my-3" formControlName="description" placeholder="{{'dashboard.Messages.Enter the text of the message' | translate}}" rows="5" cols="30" pInputTextarea></textarea>
    <div class="text-danger"
    *ngIf="this.speaEmpForm.get('description')?.touched && this.speaEmpForm.get('description')?.invalid && this.speaEmpForm.get('description')?.errors">
    <small *ngIf="this.speaEmpForm.get('description')?.errors?.['required']">{{'dashboard.Messages.descriptionMessage' | translate}}</small>
    <small *ngIf="this.speaEmpForm.get('description')?.errors?.['maxlength']">{{'dashboard.Messages.maxLength' | translate}}</small>
</div>
</div>

                        <div class="image-uploader__upload upload-btn">

            <app-file-upload view="full" (onFileUpload)="messageUpload($event)" (onFileDelete)="messageDeleted($event)"></app-file-upload>
        </div>

</div>
</form>     
<div class="elbutton">
    <button (click)="sendMessage()" style="float: left;" class="btn btn-primary" [disabled]="speaEmpForm.invalid || onSubmit"> 
        <div class="spinner-border text-light" role="status" *ngIf="onSubmit"></div>
        {{'dashboard.Messages.Send' | translate}}
    </button>
</div>

</p-dialog>