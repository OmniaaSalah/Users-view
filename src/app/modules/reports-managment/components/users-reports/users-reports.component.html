
<div class="parents" >
    <div class="search-box bg-gray-30 mb-5 border-dark radius-15">
        <div class="d-flex justify-content-between p-5 " role="button" (click)="isCollapsed = !isCollapsed">
            <span class="fs-2 color-primary">{{'Search' |translate}}</span>
            <fa-icon [icon]="isCollapsed ? faAngleDown :faAngleLeft"></fa-icon>
        </div>

        <div class="custom-form p-5 " *ngIf="isCollapsed">

            <div class="row gx-5 form-set">




                <div class="col-4">
                    <label class="label" for="city">{{'dashboard.Requests.requestType' |translate}} </label>
                    <p-multiSelect
                    [options]="requestsList"
                   display="chip"
                   [(ngModel)]="filtration.requestType" optionValue="value" optionLabel="name"
                   [ngModelOptions]="{standalone: true}"
                   placeholder="{{'dashboard.Requests.SelectRequestType' |translate}}"
                   ></p-multiSelect>
                </div>

                <div class="col-4">
                    <label class="label" for="city">{{'dashboard.UserInformation.Select Private Role'|translate }} </label>
                    <p-multiSelect
                     [options]="roles"
                    display="chip"
                    [(ngModel)]="filtration.roleIds"
                    optionValue="id"
                    [ngModelOptions]="{standalone: true}"
                    placeholder="{{'dashboard.UserInformation.Select Private Role' | translate}}"
                    optionLabel="{{lang=='ar'? 'name.ar' : 'name.en'}}"></p-multiSelect>
                </div>

                <div class="col-4">
                    <label class="label"> {{'dashboard.reports.TimeFrom-To'|translate}} <span class="star">*</span></label>
                    <p-calendar  [(ngModel)]="date" [showIcon]="true" inputId="icon" selectionMode="range"
                    placeholder="{{'dd/mm/yy'|translate}} - {{'dd/mm/yy'|translate}}" dateFormat="dd/mm/yy" [readonlyInput]="true" >
                   </p-calendar>
                </div>



            </div>


            <div class="d-flex justify-content-end align-items-center gap-5" >
                <span role="button" class="color-red-500 text-decoration-underline" (click)="clearFilter()">{{'shared.deleteAll'|translate}}</span>
                <button class="btn btn--md btn-primary" (click)="checkAvalibility()" [disabled]="isBtnLoading"  >
                    {{'Search'|translate}}
                    <div class="spinner-border text-light" role="status" *ngIf="isBtnLoading"></div>
                </button>


            </div>
        </div>

    </div>

    <div class="box-shadow bg-white raduis-12 p-5" *ngIf="(users.totalAllData|| users.loading)&& date && shownTable">
        <h3 class="heading heading-secondary fw-bold m-0 mb-5">{{'dashboard.reports.ReportSummary'|translate}}</h3>
        <div class="row mb-4">

            <h4 class="heading heading--tertiary mb-3 col col-md-4">{{'dashboard.reports.RequestNumbersProcessedFromEmployees'|translate}} :</h4>
            <p class="paragraph paragraph--sm col col-md-8">{{allRequestsNumbers}}</p>

        </div>
        <div class="row">

                <div class="row">
                <h4 class="heading heading--tertiary mb-3 col col-md-4">{{'dashboard.reports.RequestNumbersProcessedFromEmployeesBasedOnRequestType'|translate}} :</h4>
                <!-- <p class="paragraph paragraph--sm col col-md-8">{{requestsNumbersBasedOnRequestType}}</p> -->
               </div>
                <div class="row" >
                        <ng-container *ngFor="let type of requestTypes">
                        <div class="col-md-6 mb-3  align-items-center">
                        <span >{{'dashboard.Requests.'+type.requestType|translate}} : </span>
                        <span >{{type.count}}</span>
                       </div>
                        </ng-container>
                </div>


        </div>

    </div>


    <div class="bg-orange-50 p-3 radius-15 mb-5 mt-5">
        <span class="color-orange-300 ">{{'shared.note' |translate}} : </span>
        <span class="color-gray-800">" {{'dashboard.reports.you should choose the Date that you need view Employee Performance During It'|translate}} "</span>
    </div>

    <div class="prim-table" *ngIf="(users.totalAllData|| users.loading)&& date && shownTable">
        <p-table #dt [value]="users.list" [lazy]="true" (onSort)="onSort($event)">

            <ng-template pTemplate="caption">
                <app-table-caption [seachKeyword]="filtration.KeyWord" (onExport)="onExport($event)" [hasFilter]="false" (onSearch)="filtration.Page=1;filtration.KeyWord = $event; getUsersList()" (onClear)="clearFilter()">

                </app-table-caption>

            </ng-template>

            <ng-template pTemplate="header" et-columns="columns">
                <tr>
                    <ng-container *ngFor="let column of tableColumns" >
                        <th [pSortableColumn]="column.sortField" *ngIf="column.isSelected == true">
                            <!-- studentsReportsArray -->
                            <p-sortIcon field="{{column.name }}"></p-sortIcon>
                            <ng-container >{{column.name }}</ng-container>

                    </th>
                    </ng-container>

                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-e let-columns="columns">
                <tr>

                    <td>{{e?.employeeName | currentLang}}</td>
                    <td>{{(e?.school | currentLang) || ('shared.notFound' |translate)}}</td>
                    <td>{{e?.email}}</td>
                    <td>{{e?.requestNumber}}</td>
                    <td>{{e?.phoneNumber}}</td>



                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns>

                <tr>
                    <td [attr.colspan]="20">
                        <ng-container *ngIf="users.totalAllData && users.list.length == 0 &&  !users.loading">

                            <app-informative-block title="{{'emptyList.noDataMatch' |translate}}" src="assets/images/empty-list/empty-list.svg"></app-informative-block>
                        </ng-container>
                        <app-loader></app-loader>

                    </td>

                </tr>

            </ng-template>
        </p-table>

        <div>
            <div *ngIf="paginationState.rows<users.total">
                <app-pagination [currentPage]="filtration.Page" [totalItems]="users.total" (paginationChanged)="onTableDataChange($event)"></app-pagination>
            </div>
        </div>

    </div>
    <ng-container *ngIf="!users.totalAllData &&  !users.loading && date && shownTable">
        <app-informative-block title="{{'emptyList.employee' |translate}}" src="assets/images/empty-list/empty-list.svg"></app-informative-block>
    </ng-container>
</div>
